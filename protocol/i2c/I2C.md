# I2C 通訊協定

## 1. I2C 簡介
I2C（Inter-Integrated Circuit）是一種常見的串行通訊協定，主要用於短距離的設備通訊，例如感測器、EEPROM、顯示器等。

## 2. I2C 的主從設備
- **主設備（Master）**：負責生成時鐘信號並啟動通信。
- **從設備（Slave）**：通過其唯一的地址與主設備通信，並回應主設備的請求。

## 3. I2C 的雙線設計
I2C 採用 **兩條線** 進行通訊：
- **SCL（Serial Clock Line，串行時鐘線）**：  
  由 **主設備** 生成，用於同步數據傳輸。
- **SDA（Serial Data Line，串行數據線）**：  
  用於數據的雙向傳輸，所有設備共用這條數據線。

## 4. I2C 的工作原理
### **1️⃣ 起始條件（START Condition）**
- 當 **SCL 為高電平** 時，主設備將 **SDA 拉低**，表示通信開始。

### **2️⃣ 數據傳輸**
- 數據在 **SDA 線上傳輸**，每次傳輸 **1 個字節（8 位）**，並由 SCL 提供時鐘。
- **數據位的改變** 發生在 **SCL 低電平期間**，SCL **高電平時數據保持穩定**。

### **3️⃣ 應答信號（ACK/NACK）**
- 每傳輸 **一個字節** 後，接收方會回應：
  - **ACK（低電平）**：表示接收成功。
  - **NACK（高電平）**：表示接收失敗或數據傳輸結束。

### **4️⃣ 停止條件（STOP Condition）**
- 當 **SCL 為高電平** 時，主設備將 **SDA 拉高**，表示通信結束。

---
**I2C 的優勢**
- 只需 **2 條線** 即可連接多個設備。
- 支援多主機（Multi-Master）。
- 硬體需求簡單，適用於低功耗設備。

**I2C 的缺點**
- 傳輸速率較低（標準模式 100kbps，高速模式可達 3.4Mbps）。
- 受限於電容影響，線路長度不能太長。

# I2C 通訊協議 - 數據寫入格式

## 數據寫入時序
以下是 I2C 的數據寫入格式，其中 `S` 代表開始條件，`P` 代表停止條件。

| S (Start) | Slave Address | W = 0 (Write) | ACK | Data | ACK | Data | ACK | ... | Data | ACK | P (Stop) |
|-----------|--------------|---------------|-----|------|-----|------|-----|-----|------|-----|----------|
| 起始條件  | 從設備地址   | 寫入模式       | 應答 | 數據 | 應答 | 數據 | 應答 | ... | 數據 | NACK | 停止條件 |

## **說明**
1. **起始條件（S）**：
   - 當 **SCL 為高** 時，主設備將 **SDA 拉低**，標誌著通信開始。

2. **從設備地址（Slave Address）**：
   - 主設備發送 7 位或 10 位的 **從設備地址**。

3. **讀/寫位（W=0）**：
   - `W=0` 代表寫入操作。
   - `W=1` 則代表讀取操作（這張圖是寫入操作）。

4. **ACK（應答）**：
   - 每次發送 1 個字節（8 位數據）後，從設備回應：
     - `ACK = 0`（低電平）：表示數據已成功接收。
     - `NACK = 1`（高電平）：表示不再接收更多數據。

5. **數據（Data）**：
   - 主設備傳輸數據，每次 8 位。

6. **停止條件（P）**：
   - 當 **SCL 為高** 時，主設備將 **SDA 拉高**，標誌著通信結束。
