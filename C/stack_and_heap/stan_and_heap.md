# 記憶體區段（Memory Segments）、堆疊（Stack）與堆積（Heap）

在程式執行過程中，記憶體會分為不同的區段，各自有不同的用途。以下是 Stack、Heap 和其他記憶體區段的中文解釋。

---

## **1. 記憶體區段的劃分**
在典型的程式執行環境中，記憶體可以分為以下幾個區段：  
1. **程式碼區段（Code Segment）：**  
   - 存放程式執行的機器碼，屬於只讀區域（防止程式被意外修改）。  
   - 包括函式的程式碼與靜態常量。

2. **全域變數/靜態區段（Data Segment）：**  
   - **初始化資料區段（Initialized Data Segment）：**  
     儲存已初始化的全域變數與靜態變數。
   - **未初始化資料區段（BSS，Block Started by Symbol）：**  
     儲存未初始化的全域變數與靜態變數，執行時預設為 0。

3. **堆積區段（Heap）：**  
   - 用於動態記憶體分配（例如 `malloc`、`new`）。  
   - 由程式在執行時向系統申請，記憶體的釋放需由程式設計者手動處理（例如 `free`、`delete`）。  
   - 成長方向為**由低地址向高地址擴展**。

4. **堆疊區段（Stack）：**  
   - 用於儲存函式的**區域變數**、**函式參數**、**返回位址**等。  
   - 由系統自動分配與釋放，當函式呼叫結束時對應的 Stack 空間自動回收。  
   - 成長方向為**由高地址向低地址擴展**（與 Heap 相反）。

---

## **2. Stack（堆疊）的特性**
- **用途：**  
  - 儲存函式呼叫過程中的區域變數、函式參數和返回地址。
- **管理方式：**  
  - **LIFO**（Last In, First Out，後進先出），即最後壓入堆疊的資料會最先被彈出。  
- **優點：**  
  - 自動管理分配與釋放，效率高。  
- **缺點：**  
  - 空間有限，若使用過多會導致堆疊溢位（Stack Overflow）。

---

## **3. Heap（堆積）的特性**
- **用途：**  
  - 用於動態分配記憶體，例如大數據結構（陣列、鏈結串列等）。
- **管理方式：**  
  - 由程式設計者手動分配與釋放。  
  - 常用的函式有 `malloc`（分配）與 `free`（釋放），或 `new` 和 `delete`。  
- **優點：**  
  - 空間較大，適合用於需要長期保存的資料。
- **缺點：**  
  - 記憶體分配與釋放成本高，容易導致記憶體洩漏（Memory Leak）或碎片化。

---

## **4. 記憶體區段比較**

| 區段           | 用途                         | 管理方式             | 優點                  | 缺點                      |
|----------------|------------------------------|----------------------|-----------------------|---------------------------|
| **程式碼區段**  | 儲存程式碼和常量             | 系統分配（只讀）     | 穩定安全              | 無法修改                 |
| **全域/靜態區段** | 儲存全域和靜態變數           | 系統分配（靜態空間） | 高效穩定              | 靜態空間大小固定         |
| **堆疊（Stack）** | 儲存函式的區域變數與控制資訊 | 系統自動管理         | 分配/釋放效率高        | 空間有限，會有溢位風險   |
| **堆積（Heap）**  | 儲存動態分配的資料           | 手動分配與釋放       | 靈活且空間較大         | 容易洩漏或碎片化         |

---

## **5. 總結**
- **Stack（堆疊）** 用於短期的臨時數據存儲（函式內變數），具有高效但空間有限的特點。  
- **Heap（堆積）** 用於動態記憶體管理，適合儲存大數據結構，但需要注意記憶體管理問題。  
- **其他記憶體區段**（程式碼區段、全域變數區段）則屬於程式啟動時的靜態配置部分，管理由系統完成。
